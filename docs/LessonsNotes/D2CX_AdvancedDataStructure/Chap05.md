---

title: Chap 5 | â€œBinomial Queueâ€

hide:
  #  - navigation # æ˜¾ç¤ºå³
  #  - toc #æ˜¾ç¤ºå·¦
  #  - footer
  #  - feedback  
comments: true  #é»˜è®¤ä¸å¼€å¯è¯„è®º

---
<h1 id="æ¬¢è¿">Chap 5 | â€œBinomial Queueâ€</h1>
!!! note "ç« èŠ‚å¯ç¤ºå½•"
    æœ¬ç« ä»‹ç»äº†äºŒé¡¹æ ‘å’ŒäºŒé¡¹é˜Ÿåˆ—ï¼Œæˆ–è®¸è¿˜è¦è‡ªå­¦ä¸€ä¸‹æ–æ³¢é‚£å¥‘å †ã€‚å¯¹äºäºŒé¡¹é˜Ÿåˆ—è€Œè¨€ï¼Œå®ƒå¯ä»¥å¼¥è¡¥äºŒå‰å †çš„ä¸è¶³: $merge$ æ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸º $O(N)$ ã€‚äºŒé¡¹é˜Ÿåˆ—çš„ $merge$ æ“ä½œçš„æœ€åæ—¶é—´å¤æ‚åº¦ä¸º $O(logN)$ ã€‚

## 1.å®šä¹‰
åŒæ ·åœ°ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¹Ÿæƒ³å…ˆäº†è§£äºŒé¡¹é˜Ÿåˆ—çš„ä½œç”¨å’Œæ„ä¹‰ã€‚  
æˆ‘ä»¬çŸ¥é“ï¼ŒäºŒå‰å †çš„ $merge$ æ—¶é—´å¤æ‚åº¦ä¸º $O(N)$ ,ä½†æˆ‘ä»¬æƒ³æŠŠè¿™ä¸ªå¤æ‚åº¦é™ä¸‹æ¥ï¼Œé™åˆ° $O(logN)$ ï¼Œäºæ˜¯æœ‰äº†äºŒé¡¹é˜Ÿåˆ—ã€‚

!!! tips "æ€è€ƒ"
    äºŒé¡¹é˜Ÿåˆ—çš„åå­—ç”±æ¥æ˜¯ä»€ä¹ˆå‘¢ï¼ŸäºŒé¡¹ï¼Ÿä»€ä¹ˆåœ°æ–¹ä¼šå‡ºç°äºŒé¡¹ï¼ŸäºŒé¡¹å¼å®šç†ã€äºŒè¿›åˆ¶ï¼ä¸å¦¨æ€è€ƒä¸€ä¸‹äºŒé¡¹é˜Ÿåˆ—ä¸äºŒè¿›åˆ¶çš„è”ç³»ï¼Œéå¸¸çš„å·§å¦™ä¸ç¥å¥‡ã€‚

* äºŒé¡¹æ ‘ï¼šé«˜åº¦ä¸º 0 çš„äºŒé¡¹å¼æ ‘æ˜¯å•èŠ‚ç‚¹æ ‘ã€‚é«˜åº¦ä¸º $k$ çš„äºŒé¡¹å¼æ ‘ $B_k$ æ˜¯é€šè¿‡å°†äºŒé¡¹å¼æ ‘ $B_{k-1}$ é™„åŠ åˆ°å¦ä¸€ä¸ªäºŒé¡¹å¼æ ‘ $B_{k-1}$ çš„æ ¹è€Œå½¢æˆçš„ã€‚è¦æ³¨æ„çš„æ˜¯ï¼šäºŒé¡¹æ ‘åŒæ—¶æ˜¯ä¸€ä¸ªå †ï¼Œå®ƒåº”è¯¥å…·å¤‡å°æ ¹å †ï¼ˆå¤§æ ¹å †ï¼‰çš„æ€§è´¨ã€‚  
* æ€§è´¨ï¼šäºŒé¡¹æ ‘çš„èŠ‚ç‚¹ä¸ªæ•°ç­‰äºå®ƒçš„åç§°ä¸‹æ ‡ï¼ˆå¦‚ $B_3$ çš„å­èŠ‚ç‚¹ä¸ªæ•°ä¸º $3$ ï¼‰,ä¸”å®ƒçš„å­æ ‘ä¸€å®šæ˜¯ä¸€ç³»åˆ—äºŒé¡¹æ ‘ï¼ˆå¦‚ $B_3$ çš„å­æ ‘ä¸º $B_0,B_1,B_2$ ï¼‰ã€‚

![](./img/104.png)

* äºŒé¡¹é˜Ÿåˆ—ï¼šäºŒé¡¹é˜Ÿåˆ—æ˜¯äºŒé¡¹æ ‘çš„é›†åˆã€‚  
* æ€§è´¨ï¼šä¸€ä¸ªäºŒé¡¹é˜Ÿåˆ—ä¸­ï¼Œ**ä¸ä¼šå­˜åœ¨ä¸¤ä¸ªå½¢å¼ä¸Šä¸€æ ·çš„äºŒé¡¹æ ‘**ï¼ˆå³ä¸ä¼šå‡ºç°ä¸¤ä¸ªå½¢å¦‚ $B_0$ è¿™æ ·çš„äºŒé¡¹æ ‘ï¼‰ï¼Œå®ƒä»¬å°†ä¼šè¢«åˆå¹¶æˆæ–°çš„äºŒé¡¹æ ‘ï¼Œç±»ä¼¼äºäºŒè¿›åˆ¶ä¸­çš„è¿›ä½ï¼  


è¿˜è®°å¾—æˆ‘ä»¬è¯´çš„äºŒé¡¹é˜Ÿåˆ—ä¸äºŒè¿›åˆ¶ä¹‹é—´çš„è”ç³»å—ï¼Ÿå…¶å®æ¯ä¸€ä¸ªäºŒé¡¹é˜Ÿåˆ—éƒ½å¯ä»¥è¢«ç‰¹å®šåœ°è¡¨ç¤ºæˆä¸€ä¸ªäºŒè¿›åˆ¶æ•°ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚
!!! example "ä¾‹å­ğŸŒ°"
    === "Example1"
        ![](./img/105.png)  

        å¯ä»¥çœ‹åˆ°å›¾ä¸­ä»å·¦è‡ªå³ä¾æ¬¡æ˜¯ï¼š$B_2,B_1,B_0$  
        é‚£ä¹ˆè¿™ä¸ªäºŒé¡¹é˜Ÿåˆ—è¡¨ç¤ºçš„æ•°å­—å°±æ˜¯ï¼š$\large(111)_{2}=2^2+2^1+2^0=(7)_{10}$
    === "Example2"
        ![](./img/106.png)

        å¯ä»¥çœ‹åˆ°å›¾ä¸­ä»å·¦è‡ªå³ä¾æ¬¡æ˜¯ï¼š$B_2,B_0$
        é‚£ä¹ˆè¿™ä¸ªäºŒé¡¹é˜Ÿåˆ—è¡¨ç¤ºçš„æ•°å­—å°±æ˜¯ï¼š$\large(101)_{2}=2^2+2^0=(5)_{10}$
    * æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªæ•°å­—æ°å¥½æ˜¯èŠ‚ç‚¹çš„ä¸ªæ•°ã€‚
## 2.æ“ä½œ
### 2.1 FindMin
å› ä¸ºäºŒé¡¹é˜Ÿåˆ—å®é™…ä¸Šæ˜¯å †çš„é›†åˆï¼Œæ‰€ä»¥æ ¹æ®å †çš„æ€§è´¨ï¼Œæœ€å°å€¼ä½äºå…¶ä¸­ä¸€ä¸ªæ ¹ä¸­ã€‚å¯¹äºä»»æ„ $n$ ä¸ªèŠ‚ç‚¹ï¼Œå®ƒä»¬æœ€å¤šå¯ä»¥åˆ’åˆ†æˆ $\lceil logN \rceil$ ä¸ªäºŒé¡¹æ ‘ï¼Œå› æ­¤FindMinçš„æ—¶é—´å¤æ‚åº¦ä¸º $T_p=O(logN)$
!!! abstract "Note:"
    æˆ‘ä»¬å¯ä»¥è®°ä½æœ€å°å€¼ï¼Œå¹¶åœ¨æ›´æ”¹æ—¶è¿›è¡Œæ›´æ–°ã€‚ ç„¶åè¿™ä¸ªæ“ä½œå°†åªéœ€è¦ $O(1)$ã€‚

### 2.2 Merge
å¯¹äºMergeæ“ä½œæˆ‘æƒ³ç›´æ¥å€ŸåŠ©ä¸€ä¸ªä¾‹å­æ¥å±•ç¤ºï¼Œè¯·å°¤å…¶æ³¨æ„Mergeçš„æ“ä½œå…¶å®å’ŒäºŒè¿›åˆ¶çš„åŠ æ³•æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚

!!! example "ä¾‹å­ğŸŒ°"
    ![](./img/107.png){width="450"}
    ![](./img/108.png){width="200"}

    * æ³¨æ„åˆ° $H_1$ ä»£è¡¨çš„æ˜¯ $(110)_2=(6)_{10}$,$H_2$ ä»£è¡¨çš„æ˜¯ $(111)_2=(7)_{10}$ã€‚
    
    === "Step1"
        ![](./img/109.png)  

        å…ˆä» $B_0$ å¼€å§‹ï¼Œåªæœ‰ $H_2$ æœ‰ $B_0$ ï¼Œç›´æ¥æ‹¿ä¸‹æ¥ï¼Œç›¸å½“äºåŠ æ³•ä¸­æœ€æœ«ä½çš„ $0+1=1$ã€‚
    === "Step2"
        ![](./img/110.png)
    === "Step3"
        ![](./img/111.png)

### 2.3 Insert
å’Œå·¦å †çš„æ’å…¥ä¸€æ ·ï¼Œè¿™é‡Œçš„æ’å…¥ä¹Ÿæ˜¯Mergeçš„ä¸€ç§ç‰¹æ®Šå½¢å¼ã€‚
å¦‚æœæœ€å°çš„ä¸å­˜åœ¨çš„äºŒé¡¹å¼æ ‘æ˜¯ $B_i$ ,é‚£ä¹ˆ $T_p=Const*(i+1)$ã€‚  
åœ¨åˆå§‹ç©ºçš„äºŒé¡¹å¼é˜Ÿåˆ—ä¸Šæ‰§è¡Œ N ä¸ªæ’å…¥å°†èŠ±è´¹ Oï¼ˆNï¼‰ ä¸ªæœ€åæƒ…å†µçš„æ—¶é—´ã€‚ å› æ­¤ï¼Œå¹³å‡æ—¶é—´æ˜¯æ’å®šçš„ã€‚
### 2.4 DeleteMin
* Step1:FindMin in $B_k$ ã€‚
* Step2:Remove $B_k$ from $H$ ,å½¢æˆ $H^{\prime}$ ã€‚
* Step3:Remove root from $B_k$ ,å½¢æˆ $H^{\prime\prime}$ ã€‚
* Step4:Merge $(H^{\prime},H^{\prime\prime})$

!!! example "ä¸€ä¸ªä¾‹å­ğŸŒ°"
    === "Step 1"
        ![](./img/112.png)
    === "Step 2"
        ![](./img/113.png)
    === "Step 3"
        ![](./img/114.png)
    === "Step 4"
        ![](./img/115.png)
## 3.å®ç°
äºŒé¡¹é˜Ÿåˆ—çš„å®ç°æˆ‘ä»¬å¯ä»¥å‚è€ƒå°†ä»»æ„æ ‘è½¬åŒ–ä¸ºäºŒå‰æ ‘çš„æ­¥éª¤ã€‚  
å³ï¼šå°†æ¯ä¸ªèŠ‚ç‚¹çš„å·¦å­©å­æŒ‡å‘ä»–çš„å…„å¼ŸèŠ‚ç‚¹å½¢æˆé“¾è¡¨ã€‚
```C
struct BinNode 
{ 
    ElementType	    Element;
    Position	    LeftChild;
    Position 	    NextSibling;
} ;
```
![](./img/116.png)  

* æˆ‘ä»¬å¯¹å­æ ‘çš„æ’åºæœ‰ä¸¤ç§é€‰æ‹©ï¼š  
1.å‡åºæ’åˆ—å­æ ‘ï¼ˆæŒ‰å­æ ‘èŠ‚ç‚¹çš„æ•°é‡ï¼Œå³å®ƒå¯¹åº”çš„äºŒè¿›åˆ¶æ•°æˆ–è€…è¯´å®ƒçš„ä¸‹æ ‡ï¼‰  
2.é™åºæ’åˆ—å­æ ‘ï¼ˆæŒ‰å­æ ‘èŠ‚ç‚¹çš„æ•°é‡ï¼Œå³å®ƒå¯¹åº”çš„äºŒè¿›åˆ¶æ•°æˆ–è€…è¯´å®ƒçš„ä¸‹æ ‡ï¼‰  

* å…ˆç»™å‡ºç»“è®ºï¼šæˆ‘ä»¬æŒ‰ç…§é™åºæ’åˆ—ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ä¸ºä»€ä¹ˆã€‚å…¶å®ä¸»è¦è€ƒè™‘çš„å› ç´ å°±æ˜¯å‡åº/é™åºå¯¹æ“ä½œçš„æ—¶é—´å¤æ‚åº¦çš„å½±å“ã€‚æˆ‘ä»¬å¯ä»¥ç”¨Insertæ“ä½œä¸ºä¾‹è¿›è¡Œåˆ†æã€‚ 

* å¦‚æœæˆ‘ä»¬æŒ‰å‡åºæ’åˆ—ï¼Œé‚£ä¹ˆå½“äºŒé¡¹é˜Ÿåˆ—ä¸­å‡ºç°ä¸¤ä¸ªåŒç§äºŒé¡¹æ ‘æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œåˆå¹¶ï¼Œåˆå¹¶æ—¶éœ€è¦å°†å…¶ä¸­ä¸€ä¸ªäºŒé¡¹æ ‘è¿æ¥åˆ°å¦ä¸€ä¸ªäºŒé¡¹æ ‘ä¸Šã€‚å› ä¸ºæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨NextSiblingçš„æ–¹å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦éå†åˆ°æœ€åä¸€ä¸ªSiblingç„¶åæ’å…¥ï¼Œè¿™æ ·çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(logN)$ ã€‚ 

* å¦‚æœæˆ‘ä»¬æŒ‰é™åºæ’åˆ—ï¼Œæˆ‘ä»¬é€‰æ‹©Rootè¾ƒå°çš„äºŒé¡¹æ ‘ä½œä¸ºè¢«è¿æ¥å¯¹è±¡ï¼Œé‚£ä¹ˆåªéœ€è¦å…ˆå°†å¦ä¸€ä¸ªäºŒé¡¹æ ‘çš„æ ¹èŠ‚ç‚¹æŒ‡å‘LeftChild,ç„¶åå°†è¢«è¿æ¥äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹æŒ‡å‘è¿æ¥äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹å³å¯ï¼Œè¿™æ ·çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(1)$ ã€‚

ä¸‹é¢æ˜¯ç®€å•çš„ä»£ç å®ç°ï¼Œå¯ä»¥æ˜æ˜¾çœ‹å‡ºè¿™æ ·çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(1)$
```C
BinTree
CombineTrees( BinTree T1, BinTree T2 )
{  /* merge equal-sized T1 and T2 */
    if ( T1->Element > T2->Element )
        /* attach the larger one to the smaller one */
        return CombineTrees( T2, T1 );
    /* insert T2 to the front of the children list of T1 */
    T2->NextSibling = T1->LeftChild;
    T1->LeftChild = T2;
    return T1;
}
```
![](./img/117.png)

## 4.æ‘Šè¿˜åˆ†æ
* èšåˆåˆ†æï¼š   
 
![](./img/118.png)  

æˆ‘ä»¬è§‚å¯Ÿåˆ°æ¯è¿‡ $4$ ä¸ªèŠ‚ç‚¹ï¼Œä¼šå‡ºç°ä¸€æ¬¡ $link=1$;æ¯è¿‡ $8$ ä¸ªèŠ‚ç‚¹ï¼Œä¼šå‡ºç°ä¸€æ¬¡ $link=2$ â€¦â€¦  
å› æ­¤ä¸éš¾å¾—å‡ºæ€»çš„ $\large link$ æ•°ä¸º $Total \;\; links=N(\frac{1}{4}+2Ã—\frac{1}{8}+3Ã—\frac{1}{16})=O(N)$

* æ‘Šè¿˜åˆ†æï¼š
!!! success "åŠ¿èƒ½å‡½æ•°"
    $\large C_i+(\Phi_i-\Phi_{i-1})=2$   
       
    $C_i$ æ˜¯ç¬¬ $i$ æ¬¡æ’å…¥çš„costã€‚  
    $\Phi_i$ ç¬¬ $i$ æ¬¡æ’å…¥åçš„æ ‘çš„ä¸ªæ•°ã€‚ï¼ˆ$\Phi_0=0$ï¼‰
    
å°†åŠ¿èƒ½å‡½æ•°ç´¯åŠ å¾—ï¼š 

$$\large \sum_{i=0}^NC_i+\Phi_N-\Phi_0=2N$$  

$$\large \sum_{i=0}^NC_i=2N-\Phi_Nâ‰¤2N=O(N)$$

æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å‘ç°ï¼š

$$\large T_{worst}=O(logN),but \;\; T_{amortized}=2$$
