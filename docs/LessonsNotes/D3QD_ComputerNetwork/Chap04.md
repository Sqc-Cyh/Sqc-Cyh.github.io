---

title: Chap 4 | 介质访问子层

hide:
  #  - navigation # 显示右
  #  - toc #显示左
  #  - footer
  #  - feedback  
comments: true  #默认不开启评论

---
<h1 id="欢迎">Chap 4 | 介质访问子层</h1>
!!! note "章节启示录"
    <!-- === "Tab 1" -->
        <!-- Markdown **content**. -->
    <!-- === "Tab 2"
        More Markdown **content**. -->
    本章节是计算机网络的第四章。有些内容可能不重要，后续应该会标注。注意，介质访问子层的结构位于数据链路层之下！！！



## 1.信道分配问题

### 静态分配的性能分析
* 子信道的平均延迟：信道N等分后每个子信道的平均延迟时间：
    $T_{FDM}=NT$

## 2.多路访问协议
![](./img/68.png)
### 2.1 随机访问协议

* 特点：冲突不可避免

#### ALOHA协议
* 原理：想发就发

* 定义：帧时：发送一个标准长的帧所需的时间
* 服从泊松分布
    1. 一个帧时内用户产生新帧：均值 $N$ 个
    2. 一个帧时内信道中产生的帧（包括重传）：均值 $G$ 个

* 分析：
    1. $0<N<1$，轻载N接近0，重载N接近1
    2. $G>=N$，轻载 $G=N$ （无冲突）， 重载 $G>N$ （冲突/重传）

* 概率：    
    ![](./img/69.png)

* 性能分析：
    1. 吞吐量 $S$ ： $S=1$ 时分组一个接一个地发送出去，帧之间没有空隙。一般用 $S$ 接近于1的程度来衡量信道的利用率
    2. 运载负载 $G$ ,又称网络负载
    3. $P_0$ ：是一帧发送成功的概率，就是发送成功的分组再已发送分组的总数中所占的比例： $S=G * P_0$

!!! question "如何计算传输成功的概率 $P_0$"
    * 单向传播延迟Delay: $D$
    * 冲突危险期：$2D$
        1. 生成帧均值：$2G$
        2. 不遭受冲突的概率 $P_0 = e^{-2G}$

!!! warning "P[0] 和 $P_0$ 完全不同"

??? question "性能计算？"
    ![](./img/70.png)

* 分隙ALOHA工作原理：
    1. 帧的发送必须在时隙的起点
    2. 冲突只发生在时隙的起点

    ![](./img/71.png)

??? question "性能计算？"
    ![](./img/72.png)

#### CSMA
* 特点：“先听后发”


非持续式CSMA

* 特点
    1. 经侦听，如果介质空闲，开始发送
    2. 如果介质忙，则等待一个随机分布的时间，然后重复步骤1

* 好处：等待一个随机时间可以减少再次碰撞冲突的可能性

* 缺点：等待时间内介质上如果没有数据传送，这段时间是浪费的

持续式（指1-持续式）CSMA

* 特点
    1. 经侦听，如介质空闲，则发送
    2. 如介质忙，持续侦听，一旦空闲立即发送
    3. 如果发生冲突，等待一个随机分布的时间再重复步骤1
* 好处：持续式的延迟时间要少于非持续式
* 主要问题：如果两个以上的站等待发送，一旦介质空闲就一定会发生冲突

p-持续式CSMA

* 特点
    1. 经侦听，如介质空闲，那么以 p的概率 发送，以(1–p)的概率延迟一个时间单元发送
    2. 如介质忙，持续侦听，一旦空闲重复①
    3. 如果发送已推迟一个时间单元，再重复步骤1
* 注意：1-持续式是p-持续式的特例

!!! question "先听再发，避免了冲突吗？"
    CSMA：如侦听到介质上无数据发送才发送，发送后还会发生冲突吗？

    * 肯定会！
    * 两种情形: 
        1. 同时传送
        2. 传播延迟时间

        ![](./img/73.png)

* 冲突窗口：即发送站发出帧后能检测到冲突（碰撞）的最长时间。        
    数值上：等于最远两站传播时间的两倍，即2D（D是单边延迟）

CSMA/CD （1-持续）

* 原理：“先听后发、边发边听”
* 过程
    1. 经侦听，如介质空闲，则发送。
    2. 如介质忙，持续侦听，一旦空闲立即发送。
    3. 如果发生冲突，等待一个随机分布的时间再重复步骤1

!!! question "边发边听：是否发生了冲突？"
    * 一旦冲突，发送Jam（强化）信号
        1. t4时刻：甲检测到冲突，发送Jam
        2. t3时刻：乙检测到冲突，是否发送？

    ![](./img/74.png)

![](./img/75.png){width="500"}

### 2.2 受控访问协议

* 特点：克服了冲突

#### 位图协议
* 竞争期：在自己的时槽内发送竞争比特
    1. 举手示意
    2. 资源预留
* 传输期：按序发送
    1. 明确的使用权，避免了冲突

![](./img/76.png)

* 信道利用率分析:
    1. 假设：有N个用户，需N个时隙，每帧d比特
    2. 信道利用率：
        1. 在低负荷条件下：d/(d+N) （N越大，站点越多，利用率越低）
        2. 在高负荷条件下：d/(d+1)，接近100%
    3. 缺点：位图协议无法考虑优先级

#### 令牌传递：（不太重要）
1. 令牌：发送权限
2. 令牌的运行：发送工作站去抓取，获得发送权
    除了环，令牌也可以运行在其它拓扑上，如令牌总线
3. 发送的帧需要目的站或发送站将其从共享信道上去除；防止无限循环
4. 缺点：令牌的维护代价

#### 二进制倒计数协议
* 站点：编序号，序号长度相同
* 竞争期：有数据发送的站点从高序号到低序号排队，高者得到发送权
* 特点：高序号站点优先

* 信道效率分析
    1. N个站的二进制编码所需位数是 $log_2N$ 位
    2. 信道的利用率为：d/(d+log2N) （低负载时）
    3. 如果规定每个帧的帧头为发送地址，即竞争的同时也在发送。则效率为100%

### 2.3 有限竞争协议

* 特点：利用上述二者的优势

低负荷时用随机访问（想发就发），高负荷时用受控访问（需要竞争）
#### 自适应树搜索协议
1. 在一次成功传输后的第一个竞争时隙，所有站点同时竞争。
2. 如果只有一个站点申请，则获得信道。
3. 否则在下一竞争时隙，有一半站点参与竞争（递归），下一时隙由另一半站点参与竞争
4. 即所有站点构成一棵完全二叉树

![](./img/77.png)

## 3.以太网

### 3.1 经典以太网

硬件地址又称为物理地址，或 MAC 地址

* MAC子层协议